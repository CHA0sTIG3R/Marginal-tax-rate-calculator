spring.application.name=Marginal-tax-rate-calculator

# JPA schema management: create-drop, validate, update
#spring.config.activate.on-profile=prod
spring.jpa.hibernate.ddl-auto=validate

# Ingestion API key (required for /api/v1/tax/upload). Leave empty to disable uploads.
app.ingest.api-key=${APP_INGEST_API_KEY:}

tax.s3-bucket=${TAX_S3_BUCKET}
tax.s3-key=${TAX_S3_KEY}
# Enable scheduled S3 import without requiring a profile (default true)
tax.s3-import.enabled=${TAX_S3_IMPORT_ENABLED:true}
# Cron for S3 import checks (default: every 15 minutes). Example yearly run Dec 1 06:00 UTC: 0 0 6 1 12 *
tax.s3-import.cron=${TAX_S3_IMPORT_CRON}

# Database connection (PostgreSQL example)
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER:org.postgresql.Driver}

# Flyway migration configuration
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.schemas=flyway_schema
spring.flyway.default-schema=flyway_schema
spring.flyway.init-sqls=CREATE SCHEMA IF NOT EXISTS ${SPRING_FLYWAY_DEFAULT_SCHEMA:${APP_DB_SCHEMA:flyway_schema}}

# Add request correlation id (rid) to log lines
logging.pattern.level=%5p rid=%X{rid}

# Ensure JPA uses the same schema as Flyway by default 
spring.jpa.properties.hibernate.default_schema=${APP_DB_SCHEMA:${SPRING_FLYWAY_DEFAULT_SCHEMA:flyway_schema}}
